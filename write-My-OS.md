# ã¯ã˜ã‚ã«

ã‹ã­ãŒã­OSã®è‡ªä½œã‚’ã—ã¦ã¿ãŸã„ãªã¨æ€ã£ã¦ã„ãŸã®ã§
æ›¸ç±ãªã©ã‚’å‚è€ƒã«ã€OSè‡ªä½œã‚’ã‚¬ãƒƒãƒ„ãƒªå§‹ã‚ã‚‹å‰ã«
ã¾ãšã¯ç°¡æ˜“çš„ãªOSã®å®Ÿè£…ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ãŸã€‚

ã¡ã‚‡ã†ã©æ‰‹é ƒãªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’è¦‹ã¤ã‘ãŸã®ã§
è©¦ã—ã¦ã¿ãŸã‚‚ã®ã‚’ã€ç°¡å˜ãªè§£èª¬ã¨ã¨ã‚‚ã«ä½œæ¥­ãƒ­ã‚°çš„ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚

å®Ÿéš›ã«ä½œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã«ãªã‚Šã¾ã™
https://github.com/Ishizuka427/MyOS

# ç’°å¢ƒ
macOS

# å‚ç…§

ä¸»ã«å‚è€ƒã«ã—ãŸè¨˜äº‹ï¼†æ›¸ç±ã§ã™

- [Babystep1 - OSDev Wiki](https://wiki.osdev.org/Babystep1)
- [OSã‚’æ›¸ãï¼šåˆæ­©ã‹ã‚‰ä¸€æ­©ãšã¤ | POSTD](https://postd.cc/writing-an-os-baby-steps/)
- [ï¼ã‹ã‚‰ä½œã‚‹OSé–‹ç™ºã€€Vol.1ã€€ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ç·¨ Kindleç‰ˆ](https://www.amazon.co.jp/%EF%BC%90%E3%81%8B%E3%82%89%E4%BD%9C%E3%82%8BOS%E9%96%8B%E7%99%BA-Vol-1-%E3%83%96%E3%83%BC%E3%83%88%E3%83%AD%E3%83%BC%E3%83%80%E3%83%BC%E7%B7%A8-%EF%BC%90%E3%81%8B%E3%82%89%E4%BD%9C%E3%82%8B%E3%83%96%E3%83%BC%E3%83%88%E3%83%AD%E3%83%BC%E3%83%80%E3%83%BC-yabusame2001-ebook/dp/B00F6CFO9O)

# å®Ÿè¡Œç’°å¢ƒã‚’æ•´ãˆã‚‹

ã¾ãšã€å®Ÿè¡Œç’°å¢ƒã§ã™ãŒ
ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã«

- nasm
- make
- qemu

ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

â€»Dockerã‚„VMãªã©ã‚’ç”¨ã„ã¦ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’æ±šã•ãšã«è¡Œã†ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
ãŸã ä»Šå›ã®å†…å®¹ç¨‹åº¦ã§ã‚ã‚Œã°ã€ç‰¹ã«å•é¡Œãªã„ã¨åˆ¤æ–­ã—ã¾ã—ãŸã€‚
ä»Šå¾Œã€è‡ªä½œOSã‚’ç¶šã‘ãŸã„å ´åˆã¯gitç®¡ç†ãªã©ã§ä»®æƒ³ãƒã‚·ãƒ³ã¸ã®ç§»å‹•ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«ã™ã‚‹ã¨è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

```
$ brew install nasm
$ brew install make
$ brew install qemu
```

## ğŸ¾è§£èª¬

`nasm`
ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã§ã™ã€‚
æ©Ÿæ¢°ãŒç†è§£ã§ãã‚‹å‘½ä»¤ãƒ—ãƒ­ã‚°ãƒ©ãƒ **ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚³ãƒ¼ãƒ‰**ã‚’
æ©Ÿæ¢°ãŒç†è§£ã§ãã‚‹å‘½ä»¤**ãƒã‚¤ãƒŠãƒªã‚³ãƒ¼ãƒ‰**ã«ç½®ãæ›ãˆã¦ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒå®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

`make`
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

`qemu`
ã‚­ãƒ¥ãƒ¼ã‚¨ãƒŸãƒ¥ãƒ¼ã¨èª­ã¿ã¾ã™ã€‚
è‡ªä½œã—ãŸOSã¯ã€ã“ã®ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ä»‹ã—ã¦å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
ã„ã‚ã‚†ã‚‹ä»®æƒ³ãƒã‚·ãƒ³ã§ã™ã€‚

# ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®èµ·å‹•ã«ã¤ã„ã¦

ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒèµ·å‹•ã—ã¦ã‹ã‚‰ã®å‡¦ç†ã«ã¤ã„ã¦
ã‚ã‹ã‚Šã‚„ã™ã„æ¦‚è¦ã‚’è¦‹ã¤ã‘ãŸã®ã§è¨˜è¼‰ã—ã¾ã™ã€‚

>é›»æºãƒœã‚¿ãƒ³ã‚’ONã™ã‚‹ã¨ã¾ãšBIOSï¼ˆBasicInputOutputSystemï¼‰ãŒå‹•ãå‡ºã—ã¾ã™ã€‚BIOSã¯ãã®åã®é€šã‚ŠåŸºæœ¬çš„ãªï¼ˆBasicï¼‰å…¥åŠ›ï¼ˆInputï¼‰ã¨å‡ºåŠ›ï¼ˆOutputï¼‰ã‚’åˆ¶å¾¡ã™ã‚‹ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSystemï¼‰ã§ã™ã€‚ï¼ˆã“ã®ã‚ãŸã‚Šã¯åˆ¥ã«èª­ã¿é£›ã°ã—ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚BIOSãŒå‹•ãå‡ºã™ã¨POSTï¼ˆPowerOnSelfTestï¼‰ã¨å‘¼ã°ã‚Œã¦ã„ã‚‹å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚POSTå‡¦ç†ã§ã¯æ¥ç¶šã•ã‚ŒãŸãƒ‡ãƒã‚¤ã‚¹ã®ãƒã‚§ãƒƒã‚¯ãƒ»åˆæœŸè¨­å®šã€ãƒ¡ãƒ¢ãƒªãƒ¼ã®ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã£ã¦æ­£å¸¸ã«ã‚·ã‚¹ãƒ†ãƒ ãŒèµ·å‹•ã§ãã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚èµ·å‹•ã§ãã‚‹ã¨åˆ¤æ–­ã™ã‚‹ã¨æ¬¡ã«ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ã¾ãŸã¯OSã‚’ãƒ¡ãƒ¢ãƒªãƒ¼ã«ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ã¾ãŸã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå¾Œã«ãã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒæ§˜ã€…ãªå‡¦ç†ã‚’ç°¡å˜ã«è¡Œãˆã‚‹ã‚ˆã†ã«ã€BIOSã¯å…¥å‡ºåŠ›ãƒ‡ãƒã‚¤ã‚¹ã®æ“ä½œã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰åˆ©ç”¨ã§ãã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚
--ã€Œ0ã‹ã‚‰ä½œã‚‹OSé–‹ç™ºã€ã‹ã‚‰å¼•ç”¨--

MBR(ãƒã‚¹ã‚¿ãƒ¼ãƒ–ãƒ¼ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰)ã®å®¹é‡ã«ã¯ä¸Šé™ãŒã‚ã‚‹ãŸã‚ã€ãã‚Œä»¥ä¸Šã®ãƒ­ãƒ¼ãƒ‰ã«ã¯ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ãŒç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚
ä»Šå›ä½œæˆã™ã‚‹OSã¯ã¨ã¦ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªãŸã‚ã€ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã‚’ä½¿ç”¨ã—ã¦ã•ã‚‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã¯ã—ã¾ã›ã‚“ã€‚

# ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã‚‹

å®Ÿéš›ã«ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã¾ã™ã€‚

```
$ vi boot.asm
```

```nasm:boot.asm
; boot.asm
hang:
jmp hang
 
times 510-($-$$) db 0
 
; This is a comment
 
db 0x55
db 0xAA
```

## ğŸ¾è§£èª¬

`hang`
ã‚³ãƒ¼ãƒ‰å†…ã®åå‰ã¤ããƒãƒ¼ã‚«ãƒ¼ã§ã™ã€‚

`jmp hang`
ãƒãƒ¼ã‚«ãƒ¼hangã«ã‚¸ãƒ£ãƒ³ãƒ—ã—ã¾ã™ã€‚ã“ã‚Œã§ç„¡é™ãƒ«ãƒ¼ãƒ—ã«ãªã‚Šã¾ã™ã€‚

`times 510-($-$$) db 0`
æ®‹ã‚Šã®ãƒã‚¤ãƒˆã‚’0ã§åŸ‹ã‚ã‚‹ãŸã‚ã®nasmæ§‹æ–‡ã§ã™ã€‚

`$`
ç¾åœ¨ã®è¡Œã®å…ˆé ­

`$$`
ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å…ˆé ­

`($-$$)`
ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã‹ã‚‰ç¾åœ¨ã®ä½ç½®ã‚’å¼•ã
2ã¤ã®dbã‚³ãƒãƒ³ãƒ‰ãŒã€æœ€å¾Œã«2ãƒã‚¤ãƒˆåˆ†ã§æ ¼ç´ã™ã‚‹ã®ã§
MBRã®æ®‹ã‚Šã®512ãƒã‚¤ãƒˆã‚’åŸ‹ã‚ã‚‹ã®ã«512ã¨ã„ã†æ•°ã‚’ä½¿ã„ã¾ã›ã‚“ã€‚

`;`
ã‚³ãƒ­ãƒ³ä»¥é™ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã«ãªã‚Šã¾ã™ã€‚

`0x55ã¨0xAA`
BIOSã«ã€Œã¯ã„ã€ã“ã‚Œã¯å®Ÿè¡Œå¯èƒ½ãªMBRã§ã™ã€ã¨çŸ¥ã‚‰ã›ã¾ã™ã€‚
ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—ã¦ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒå®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```console
$ nasm -f bin boot.asm -o boot.bin
```

## ğŸ¾è§£èª¬

`-f bin`
nasmãŒãƒã‚¤ãƒŠãƒªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¾ã™ã€‚

`boot.asm`
nasmãŒã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

`boot.bin`
å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã§ã™ã€‚

ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```
$ qemu-system-x86_64 boot.bin
```

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/449552/f583ea74-4001-e6ad-913c-9d87ddd91d06.png)

ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸğŸ‘

# Makefileã®ä½œæˆ

æ¬¡ã«ã€Makefileã‚’ä½œæˆã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚

```
$ vi Makefile
```

```make:Makefile
boot.bin: boot.asm
	nasm -f bin boot.asm -o boot.bin
 
qemu: boot.bin
	qemu-system-x86_64 boot.bin
 
clean:
	rm *.bin
```

## ğŸ¾Makefileã®æ–‡æ³•è§£èª¬

```makefile:Makefile
ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåÎ±: ä¾å­˜ãƒ•ã‚¡ã‚¤ãƒ«åÎ±
    ã‚³ãƒãƒ³ãƒ‰è¡ŒÎ±

ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåÎ²: ä¾å­˜ãƒ•ã‚¡ã‚¤ãƒ«åÎ²
    ã‚³ãƒãƒ³ãƒ‰è¡ŒÎ²

ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåÎ³: ä¾å­˜ãƒ•ã‚¡ã‚¤ãƒ«åÎ³
    ã‚³ãƒãƒ³ãƒ‰è¡ŒÎ³
```

ã‚¿ãƒ¼ã‚²ãƒƒãƒˆåã‚’æŒ‡å®šã—ã¦makeã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯
`$ make ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå`
ã¨ã—ã¾ã™ã€‚ã¾ãŸã€ã‚³ãƒ­ãƒ³ã®å¾Œã®å€¤ã¯ä¾å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

ä¾‹â‘ 

```
$ make qemu
```
ğŸ‘†ã“ã¡ã‚‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€**make**ã¯`boot.bin`ã®ã‚³ãƒãƒ³ãƒ‰ï¼ˆ`nasm -f bin boot.asm -o boot.bin`ï¼‰ã‚’å®Ÿè¡Œã—ãŸã‚ã¨ã€`qemu-system-x86_64 boot.bin`ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

ä¾‹â‘¡

```
$ make clean
```

ğŸ‘†ã“ã¡ã‚‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`rm *.bin`ãŒå®Ÿè¡Œã•ã‚Œã€ã™ã¹ã¦ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰Šé™¤ã•ã‚Œã¾ã™ã€‚

â€»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’çœç•¥ã™ã‚‹ã¨Makefileã®ä¸­ã§å…ˆé ­ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
**[æ³¨æ„âš ]Makefileå†…ã§ã‚³ãƒãƒ³ãƒ‰è¡Œã‚’è¨˜è¿°ã™ã‚‹å ´åˆã¯ã€å¿…ãšå…ˆé ­ã«ã‚¿ãƒ–æ–‡å­—ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚**

# æ–‡å­—ã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹

`boot.asm`ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ãæ›ãˆã¦ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã«æ–‡å­—ã‚’è¡¨ç¤ºã•ã›ã¦ã¿ã¾ã™ã€‚

```console
$ vi boot.asm
```

```nasm:boot.asm
; boot.asm
mov ax, 0x07c0
mov ds, ax
 
mov ah, 0x0
mov al, 0x3
int 0x10
 
mov si, msg
mov ah, 0x0E
 
print_character_loop:
lodsb
 
or al, al
jz hang
 
int 0x10
 
jmp print_character_loop
 
msg:
db 'Hello, World!', 13, 10, 0
 
hang:
jmp hang
 
times 510-($-$$) db 0
 
db 0x55
db 0xAA
```

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ãŸã‚‰å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```
$ make clean
$ make qemu
```

## ğŸ¾è§£èª¬

```
mov ax, 0x07c0
mov ds, ax
```

`mov`ã¯ãƒ‡ãƒ¼ã‚¿ã‚’å‹•ã‹ã™å‘½ä»¤ã§ã™ã€‚
ã“ã“ã§ã¯`0x07c0`ã‚’æ±ç”¨ãƒ¬ã‚¸ã‚¹ã‚¿`ax` (ã‚¢ã‚­ãƒ¥ãƒ ãƒ¬ãƒ¼ã‚¿)ã¸ç§»å‹•ã—ãŸã‚ã¨ã«`ax`ã‚’`ds`(ãƒ‡ãƒ¼ã‚¿ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ)ã«ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
BIOSã¯æ¯å›`0x07c0:0x0000`ã®ä½ç½®ã«MBRã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã€ã“ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚
`ds`ã¯ãƒ¬ã‚¸ã‚¹ã‚¿ã‹ã‚‰ç§»å‹•ã—ã¦ããŸãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’å—ã‘å–ã‚‹ä»•æ§˜ã®ãŸã‚ã€ã“ã®ã‚ˆã†ã«æ®µéšã‚’è¸ã‚“ã§ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—ã‚’è¡Œã„ã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/449552/9c0f9b50-14d5-afb3-434e-befb86028db8.png)


`ãƒ¬ã‚¸ã‚¹ã‚¿`
CPUå†…ã®è¨˜æ†¶è£…ç½®ã§ã™ã€‚
ãã‚Œãã‚Œã«å½¹å‰²ãŒã‚ã‚Šã€ä¾‹ãˆã°ä»Šå›ã®ã‚±ãƒ¼ã‚¹ã§ã¯ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ¬ã‚¸ã‚¹ã‚¿ã«å€¤ã‚’å…¥ã‚Œã‚‹ã“ã¨ã§ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®é–‹å§‹ä½ç½®ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚
0x07C0ã‚’dsãƒ¬ã‚¸ã‚¹ã‚¿ãƒ¼ã«æ ¼ç´ã™ã‚‹ã“ã¨ã§ã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®é–‹å§‹ä½ç½®ãŒ0x7C00ã«ãªã‚Šã¾ã™ã€‚

`ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ`
ãƒ¡ãƒ¢ãƒªãƒ¼ã‚’ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨å‘¼ã°ã‚Œã‚‹ã‚ã‚‹ç¨‹åº¦ã®å¤§ãã•ã«åŒºåˆ‡ã£ãŸã‚‚ã®ã‚’ã„ã„ã¾ã™ã€‚
å…¨å®¹é‡ã®ä¸Šé™ã¯æ±ºã¾ã£ã¦ã„ã¾ã™ãŒã€ä¸€ã¤ä¸€ã¤ã®å¤§ãã•ã‚„ãƒ¡ãƒ¢ãƒªãƒ¼ä¸Šã®å ´æ‰€ã‚’è‡ªåˆ†ã§å¤‰æ›´ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
ã¾ãŸã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåŒå£«ã®é ˜åŸŸã¯ãŠäº’ã„é‡è¤‡ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/449552/424a129f-0636-5fb3-a33d-e9a7a2098907.png)

(å‚ç…§: ã€Œ0ã‹ã‚‰ä½œã‚‹OSé–‹ç™ºã€)

ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã«ã¤ã„ã¦ã–ã£ãã‚Šã¨è§£èª¬ã‚’ã—ã¾ã™ã€‚

```nasm:(è§£èª¬ç”¨)
; boot.asm
mov ax, 0x07c0    ; 0x07c0 ã‚’ ax ã«å‹•ã‹ã™
mov ds, ax        ; ax ã‚’ dx ã«å‹•ã‹ã™

mov ah, 0x0       ; 0x0 ã‚’ ah ã«å‹•ã‹ã™
mov al, 0x3       ; 0x3 ã‚’ al ã«å‹•ã‹ã™
int 0x10          ; ä¸Šè¨˜ã‚’ 0x10 (ãƒ“ãƒ‡ã‚ªã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†ã™ã‚‹BIOS)ã« intå‘½ä»¤ã§å‰²ã‚Šè¾¼ã¿ 
 
mov si, msg       ; msg ã‚’ si ã¸å‹•ã‹ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã« msg ã‚’æ ¼ç´
mov ah, 0x0E      ; 0x0E ã‚’ ah ã¸å‹•ã‹ã™ã€‚ç”»é¢ã®æ–‡å­—åˆ—ã‚’ 0x10 ã¸å‰²ã‚Šè¾¼ã¿å¯èƒ½ã«

; ãƒ«ãƒ¼ãƒ—é–‹å§‹
print_character_loop:    
lodsb             ; lodsbå‘½ä»¤ si ã‹ã‚‰ al ã«1byteãƒ­ãƒ¼ãƒ‰ã™ã‚‹  
 
or al, al         ; al(0x3)ã¨(0x3)ã‚’oræ¼”ç®—ã€‚æ–‡å­—åˆ—ãŒ0ã«ãªã‚Šçµ‚ã‚ã‚‹ã¨ã€ãƒ—ãƒ­ã‚»ãƒƒã‚µã¯ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã®ä½ç½®ã«ã‚¸ãƒ£ãƒ³ãƒ— 
jz hang

int 0x10          ; æ–‡å­—åˆ—ã‚’ç”»é¢ã«ãƒ—ãƒªãƒ³ãƒˆã™ã‚‹

jmp print_character_loop    ; ãƒ«ãƒ¼ãƒ—ã®å…ˆé ­ã«æˆ»ã‚Šã€æ–‡å­—åˆ—ãŒçµ‚ã‚ã‚Šã§ãªã‘ã‚Œã°æ¬¡ã®æ–‡å­—ã‚’ãƒ—ãƒªãƒ³ãƒˆã™ã‚‹ã€‚
; ãƒ«ãƒ¼ãƒ—ã“ã“ã¾ã§

msg:
db 'Hello, World!', 13, 10, 0    ; db => ã“ã‚Œã‚‰ã®å€¤ã‚’msg:ã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ ¼ç´ã™ã‚‹ã‚ˆã†å‘½ã˜ã‚‹

hang:
jmp hang

times 510-($-$$) db 0

db 0x55
db 0xAA
```

Hello, WorldãŒè¡¨ç¤ºã•ã‚ŒãŸç”»é¢ãŒã“ã¡ã‚‰ã§ã™ğŸ‘

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/449552/f9a20795-e94b-dd3c-5ede-b7ab2fdb7e1e.png)

# Nextã‚¹ãƒ†ãƒƒãƒ—ã«ã‚ªã‚¹ã‚¹ãƒ¡ã®æ›¸ç±

[30æ—¥ã§ã§ãã‚‹! OSè‡ªä½œå…¥é–€ Kindleç‰ˆ](https://www.amazon.co.jp/dp/B00IR1HYI0/ref=dp-kindle-redirect?_encoding=UTF8&btkr=1)



